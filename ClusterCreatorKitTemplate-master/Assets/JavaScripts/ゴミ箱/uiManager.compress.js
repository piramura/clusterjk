function e(){const e=$.getPosition(),s=$.getPlayersNear(e,100);let t=[];s.forEach((e=>{let s=e.id,r=e.userDisplayName,o=$.state.scores[s]||0;t.push({name:r,score:o})}));const r=$.subNode("PlayerList");t.forEach((e=>{let s=`Player: ${e.name} - Score: ${e.score}`;r.setText(s)}))}$.onStart((()=>{$.state.isQuestionComplete=!0;let e=$.state.playerAnswers||{};$.state.playerAnswers=e;let s=$.state.scores||{};$.state.scores=s,$.log("START!!!")})),$.onReceive(((a,l,i)=>{switch(a){case"loadQuestion":!function(){if($.log("recieve!"),$.state.isQuestionComplete){let a=$.state.questionIndex||0;(e=a)<n.length?(s.setText(n[e].question),t.setText(n[e].choices[0]),r.setText(n[e].choices[1]),o.setText(""),$.log(`Displaying question: ${n[e].question}`)):(s.setText("クイズ終了！"),o.setText(""),$.log("Quiz finished!")),$.log(`Question ${a+1} displayed.`);let l=!1;$.state.isQuestionComplete=l}else $.log(`Current state of 'isQuestionComplete': ${$.state.isQuestionComplete}`);var e}();break;case"playerAnswered":$.log(`Received arg: ${JSON.stringify(l)}`);let a=l.playerId,i=l.choice;$.log(`Before setting: ${JSON.stringify($.state.playerAnswers[a])}`),$.state.playerAnswers=$.state.playerAnswers||{};let c=$.state.playerAnswers||{};c[a]=i,$.state.playerAnswers=c,$.log(`After setting: ${JSON.stringify($.state.playerAnswers[a])}`),$.log(`Player ${l.playerId} answer saved as ${l.choice}`),function(s){let t=s.playerId,r=s.choice,o=$.state.playerAnswers||{};$.state.playerAnswers[t]=r,$.state.playerAnswers=o,function(e,s){$.log(`Player ${e} selected choice: ${s}`)}(t,r),$.log(`playerId: ${t}`),$.log(`playerAnswers object: ${JSON.stringify($.state.playerAnswers)}`),$.log(`Saved Answers: ${JSON.stringify($.state.playerAnswers[t])}`);const a=function(e=100){const s=$.getPosition(),t=$.getPlayersNear(s,e),r=Object.keys($.state.playerAnswers||{}),o=t.map((e=>e.id));$.log(`All Player IDs: ${o.join(", ")}`),$.log(`Answered Player IDs: ${r.join(", ")}`),o.forEach((e=>{const s=r.includes(e);$.log(`ID: ${e}, Answered: ${s}`)}));const n=o.filter((e=>!r.includes(e)));return $.log(`Not Answered Player IDs: ${n.join(", ")}`),{totalPlayers:o.length,answeredPlayers:r.length,notAnsweredPlayers:n.length,answeredPlayerIds:r,notAnsweredPlayerIds:n}}(100);(function(e){$.log(`Total Players: ${e.totalPlayers}`),$.log(`Answered Players: ${e.answeredPlayers}`),$.log(`Not Answered Players: ${e.notAnsweredPlayers}`),$.log(`Answered Player IDs: ${e.answeredPlayerIds.join(", ")}`),$.log(`Not Answered Player IDs: ${e.notAnsweredPlayerIds.join(", ")}`)})(a),0===a.notAnsweredPlayers?($.log("All players have answered. Proceeding to process results."),e(),function(){let s=$.state.questionIndex||0,t=n[s].correct_answer;$.state.scores;for(let s in $.state.playerAnswers){let r=$.state.playerAnswers[s];if($.log(`Correct Answer: ${t}`),$.log(`Player's Answer: ${r}`),r==t){let t=$.state.scores||{};$.log(`Before updating score: ${JSON.stringify($.state.scores)}`),t[s]=(t[s]||0)+1,$.state.scores=t,$.log(`After updating score: ${JSON.stringify($.state.scores)}`),e(),$.log(`Player ${s} answered correctly!`)}else $.log(`Player ${s} answered incorrectly.`)}$.state.questionIndex=s+1;let r=!0;$.state.isQuestionComplete=r}()):$.log(`${a.notAnsweredPlayers} players have not answered yet.`)}(l)}}));const s=$.subNode("QuestionText"),t=$.subNode("SelectionAText"),r=$.subNode("SelectionBText"),o=$.subNode("AnswerText"),n=[{question:"日本の首都はどこですか？",choices:["A. 大阪","B. 東京"],correct_answer:"B"},{question:"富士山の高さはどれくらいですか？",choices:["A. 3,776m","B. 2,500m"],correct_answer:"A"},{question:"日本で最も人口が多い都市は？",choices:["A. 東京","B. 横浜"],correct_answer:"A"},{question:"日本の国花は何ですか？",choices:["A. 桜","B. 菊"],correct_answer:"A"},{question:"日本の通貨単位は何ですか？",choices:["A. 円","B. ドル"],correct_answer:"A"},{question:"北海道の県庁所在地はどこですか？",choices:["A. 札幌","B. 函館"],correct_answer:"A"},{question:"沖縄県の県庁所在地はどこですか？",choices:["A. 那覇","B. 名護"],correct_answer:"A"},{question:"日本の国鳥は何ですか？",choices:["A. キジ","B. ツル"],correct_answer:"A"},{question:"日本の国技は何ですか？",choices:["A. 相撲","B. 剣道"],correct_answer:"A"},{question:"日本で最も高いビルはどれですか？",choices:["A. あべのハルカス","B. 東京スカイツリー"],correct_answer:"A"}];