const e=[$.subNode("Name_1"),$.subNode("Name_2"),$.subNode("Name_3")],s=[$.subNode("Score_1"),$.subNode("Score_2"),$.subNode("Score_3")];$.onStart((()=>{$.state.records=[]})),$.onInteract((e=>{let s=$.state.records,t={name:e.userDisplayName,score:$.getStateCompat("owner","score","integer")},n=s.findIndex((e=>e.name===t.name));-1!==n?($.log("Existing name: "+r.name),s[n].score=t.score):s.push(t),$.state.records=s;let a={type:"rankingSample",records:s,top:3},o=JSON.stringify(a);$.log("Sending request to server: "+o),$.callExternal(o,"syncRanking"),$.state.records=[]})),$.onExternalCallEnd(((r,t,n)=>{if(null!=r){if("syncRanking"===t)try{let t=JSON.parse(r);$.log("Received response from server: "+r);for(let r=0;r<3;r++)r<t.rankers.length?(e[r].setText(t.rankers[r].name),s[r].setText(t.rankers[r].score)):(e[r].setText(""),s[r].setText(""))}catch(e){$.log("JSON parse error: "+e.message)}}else $.log("callExternal ERROR: "+n)}));